<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <style>
        @page {
            size: A4;
            margin: 36pt;
            @top-center {
                content: "$!{headerText}";
                font-size: 9pt;
                color: #666;
                font-family: "Noto Sans CJK SC", "Noto Serif CJK SC", "WenQuanYi Zen Hei", "SimSun", "SimHei", "Microsoft YaHei", "Helvetica Neue", Arial, sans-serif;
            }
            @bottom-center {
                content: #[[ "第 " counter(page) " 页 / 共 " counter(pages) " 页" ]]#;
                font-size: 9pt;
                color: #666;
                font-family: "Noto Sans CJK SC", "Noto Serif CJK SC", "WenQuanYi Zen Hei", "SimSun", "SimHei", "Microsoft YaHei", "Helvetica Neue", Arial, sans-serif;
            }
        }
        @font-face {
            font-family: "Noto Sans CJK SC";
            font-weight: 100;
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "Noto Sans CJK SC";
            font-weight: 300;
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "Noto Sans CJK SC";
            font-weight: 350;
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "Noto Sans CJK SC";
            font-weight: 400;
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "Noto Sans CJK SC";
            font-weight: 500;
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "Noto Sans CJK SC";
            font-weight: 700;
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "Noto Sans CJK SC";
            font-weight: 900;
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "Noto Serif CJK SC";
            font-weight: 400;
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "Noto Serif CJK SC";
            font-weight: 700;
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "WenQuanYi Zen Hei";
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "SimSun";
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "SimHei";
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        @font-face {
            font-family: "Microsoft YaHei";
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }
        body {
            font-family: "Noto Sans CJK SC", "Noto Serif CJK SC", "WenQuanYi Zen Hei", "SimSun", "SimHei", "Microsoft YaHei", "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            font-size: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            background-color: #fff;
            table-layout: auto;
        }
        thead tr {
            background-color: #f5f5f5;
        }
        th {
            padding: 10px 8px;
            border: 1px solid #c8c8c8;
            font-weight: 600;
            text-align: center;
            color: #333;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tbody tr:nth-child(odd) {
            background-color: #ffffff;
        }
        td {
            padding: 10px 8px;
            border: 1px solid #c8c8c8;
            color: #666;
            word-wrap: break-word;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .col-narrow {
            width: auto;
            min-width: 60px;
        }
        .col-medium {
            width: auto;
            min-width: 100px;
        }
        .col-wide {
            width: auto;
            min-width: 150px;
        }
        .col-extra-wide {
            width: auto;
            min-width: 200px;
        }
    </style>
</head>
<body>
<table>
    <thead>
        <tr>
            #foreach($fieldInfo in $fieldInfos)
                #set($key = $fieldInfo.key)
                #set($labelLength = $fieldInfo.label.length())
                #if($key == "title" || $key == "summary" || $key == "problemDescription" || $key == "fixSolution" || $key == "exampleCode" || $key == "referenceLink")
                    #set($colClass = "col-extra-wide")
                #elseif($key == "itemUuid" || $key == "cweId" || $key == "cweName" || $key == "cweNameZh" || $key == "cweNameEn")
                    #set($colClass = "col-wide")
                #elseif($labelLength > 8 || $key.contains("Time") || $key.contains("Date") || $key.contains("By") || $key.contains("Name"))
                    #set($colClass = "col-medium")
                #else
                    #set($colClass = "col-narrow")
                #end
                <th class="$colClass">$utils.escapeHtml($fieldInfo.label)</th>
            #end
        </tr>
    </thead>
    <tbody>
        #foreach($item in $items)
            <tr>
                #foreach($fieldInfo in $fieldInfos)
                    #set($key = $fieldInfo.key)
                    #set($labelLength = $fieldInfo.label.length())
                    #if($key == "title" || $key == "summary" || $key == "problemDescription" || $key == "fixSolution" || $key == "exampleCode" || $key == "referenceLink")
                        #set($colClass = "col-extra-wide")
                    #elseif($key == "itemUuid" || $key == "cweId" || $key == "cweName" || $key == "cweNameZh" || $key == "cweNameEn")
                        #set($colClass = "col-wide")
                    #elseif($labelLength > 8 || $key.contains("Time") || $key.contains("Date") || $key.contains("By") || $key.contains("Name"))
                        #set($colClass = "col-medium")
                    #else
                        #set($colClass = "col-narrow")
                    #end
                    #set($value = $utils.getFieldValue($item, $key, $cweMap, $tagMap, $userMap, $knowledgeBaseMap, $fieldFormats))
                    #if($value && $value.length() > 100)
                        #set($value = $value.substring(0, 100) + "...")
                    #end
                    <td class="$colClass">$utils.escapeHtml($value)</td>
                #end
            </tr>
        #end
    </tbody>
</table>
</body>
</html>
